<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bihar NDA Win: Nitish Kumar Takes Oath | E TIMES INDIA * 24</title>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
      rel="stylesheet"
    />
    <link rel="shortcut icon" href="/logo/logo2.png" type="image/x-icon">
    <link
      href="https://fonts.googleapis.com/css2?family=Antonio:wght@700&family=Roboto:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family: "Roboto", sans-serif;
        background: #fff;
        color: #222;
        min-height: 100vh;
        position: relative;
        overflow-x: hidden;
        line-height: 1.5;
      }

      /* Animated Background */
      .bg-spots {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: radial-gradient(
            circle at 20% 30%,
            #ff1a1a 0%,
            transparent 30%
          ),
          radial-gradient(circle at 80% 70%, #c80000 0%, transparent 35%),
          radial-gradient(circle at 50% 10%, #ff4d4d 0%, transparent 28%),
          radial-gradient(circle at 10% 80%, #ff3333 0%, transparent 32%),
          radial-gradient(circle at 90% 20%, #e60000 0%, transparent 30%);
        background-size: 600px 600px, 700px 700px, 500px 500px, 650px 650px,
          550px 550px;
        background-position: 0 0, 100px 200px, -50px -100px, 300px 400px,
          -200px 100px;
        opacity: 0.12;
        animation: floatSpots 45s ease-in-out infinite alternate;
        z-index: -1;
        pointer-events: none;
      }
      @keyframes floatSpots {
        0% {
          background-position: 0 0, 100px 200px, -50px -100px, 300px 400px,
            -200px 100px;
        }
        100% {
          background-position: 50px 50px, 150px 250px, 0 -50px, 350px 450px,
            -150px 150px;
        }
      }

      /* Header */
      header {
        background: #fff;
        padding: 12px 20px;
        position: sticky;
        top: 0;
        z-index: 1000;
        box-shadow: 0 4px 25px rgba(200, 0, 0, 0.15);
        border-bottom: 3px solid #c80000;
      }
      .top-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 15px;
        max-width: 1600px;
        margin: 0 auto;
      }
      .logo {
        height: 65px;
      }
      .logo-img{
        height:45px;
        width:auto;
      }
      .menu-toggle {
        display: none;
        cursor: pointer;
        font-size: 24px;
        color: #c80000;
        padding: 5px;
      }
      nav ul {
        display: flex;
        gap: 20px;
        list-style: none;
        flex-wrap: wrap;
        justify-content: center;
      }
      nav a {
        color: #c80000;
        text-decoration: none;
        font-weight: 700;
        font-size: 14px;
        text-transform: uppercase;
        padding: 8px 0;
        position: relative;
        transition: 0.3s;
      }
      nav a::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 0;
        width: 0;
        height: 2px;
        background: #c80000;
        transition: 0.3s;
      }
      nav a:hover::after {
        width: 100%;
      }

      /* Ticker */
      .ticker {
        background: #c80000;
        color: #fff;
        padding: 10px 0;
        font-weight: 700;
        overflow: hidden;
        white-space: nowrap;
      }
      .ticker span {
        display: inline-block;
        animation: scrollLeft 100s linear infinite;
        padding-left: 100%;
        font-size: 15px;
      }
      @keyframes scrollLeft {
        0% {
          transform: translateX(0);
        }
        100% {
          transform: translateX(-100%);
        }
      }

      /* Live Info */
      .live-info {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 20px;
        background: #111;
        color: #fff;
        font-size: 14px;
        flex-wrap: wrap;
        gap: 10px;
      }

      /* Container */
      .container {
        max-width: 1600px;
        margin: 20px auto;
        padding: 0 15px;
        display: grid;
        grid-template-columns: 280px 1fr 320px;
        gap: 20px;
      }

      /* Sidebar Toggle (Mobile) */
      .sidebar-toggle {
        position: fixed;
        left: 15px;
        top: 120px;
        background: #c80000;
        color: #fff;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 22px;
        cursor: pointer;
        z-index: 999;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
        display: none;
      }

      /* Live Video */
      .live-video {
        position: relative;
        margin-bottom: 25px;
        border-radius: 16px;
        overflow: hidden;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      }
      .live-badge {
        position: absolute;
        top: 15px;
        left: 15px;
        background: #c80000;
        color: #fff;
        padding: 10px 25px;
        border-radius: 50px;
        font-weight: bold;
        font-size: 16px;
        animation: flash 1.5s infinite;
        z-index: 10;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
      }
      @keyframes flash {
        0%,
        100% {
          background: #c80000;
        }
        50% {
          background: #ff1a1a;
        }
      }
      .live-video video {
        width: 100%;
        height: 480px;
        object-fit: cover;
        display: block;
      }
      .live-video h2 {
        background: #ffffff;
        color: #ff0000;
        padding: 16px;
        text-align: center;
        font-size: 19px;
        margin: 0;
      }

      /* Cards & Grids */
      .news-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 18px;
      }
      .news-card {
        background: #fff;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s;
      }
      .news-card:hover {
        transform: translateY(-8px);
      }
      .news-card img {
        width: 100%;
        height: 180px;
        object-fit: cover;
      }
      .news-card h3 {
        font-size: 16px;
        margin: 12px 14px 8px;
        line-height: 1.3;
      }
      .news-card p {
        font-size: 13px;
        color: #555;
        margin: 0 14px 14px;
      }

      /* Section Headers */
      .section-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin: 30px 0 15px;
        padding: 0 5px;
      }
      .section-header h2 {
        font-size: 22px;
        color: #c80000;
        font-weight: 700;
        position: relative;
        padding-left: 18px;
      }
      .section-header h2::before {
        content: "";
        position: absolute;
        left: 0;
        top: 50%;
        transform: translateY(-50%);
        width: 6px;
        height: 28px;
        background: #c80000;
        border-radius: 3px;
      }

      /* Mandi & Categories */
      .categories {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 12px;
        margin-bottom: 25px;
      }
      .cat-item {
        background: #f8f8f8;
        padding: 16px 10px;
        text-align: center;
        border-radius: 12px;
        font-weight: bold;
        color: #c80000;
        transition: 0.3s;
        font-size: 14px;
      }
      .cat-item:hover {
        background: #c80000;
        color: #fff;
      }

      .mandi-section {
        background: linear-gradient(135deg, #c80000, #ff1a1a);
        color: #fff;
        padding: 20px;
        border-radius: 16px;
        margin: 0px 0;
      }
      .mandi-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
        gap: 16px;
      }
      .mandi-table {
        width: 100%;
        border-collapse: collapse;
        color: #fff;
      }
      .mandi-table td {
        padding: 4px 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      }
      .mandi-table td:first-child {
        text-align: left;
        padding-right: 10px;
      }
      .mandi-table td:last-child {
        text-align: center;
        font-weight: bold;
      }

      /* Ads */
      .ad-banner {
        background: #f0f0f0;
        border: 3px dashed #c80000;
        color: #c80000;
        text-align: center;
        padding: 30px 10px;
        border-radius: 12px;
        font-weight: bold;
        margin: 20px 0;
      }

      /* Footer */
      footer {
        background: #111;
        color: #ccc;
        padding: 60px 20px 40px;
        margin-top: 80px;
      }
      .footer-grid {
        max-width: 1400px;
        margin: auto;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 40px;
      }
      .footer-col h3 {
        color: #c80000;
        margin-bottom: 10px;
      }

      /* Loader */
      .loader {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: #fff;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        transition: opacity 0.5s;
      }
      .loader .spinner {
        width: 80px;
        height: 80px;
        border: 8px solid #f3f3f3;
        border-top: 8px solid #c80000;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }
      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      /* RESPONSIVE DESIGN */
      @media (max-width: 1200px) {
        .container {
          grid-template-columns: 1fr 1fr;
        }
        .right-sidebar {
          grid-column: 1 / -1;
        }
        .news-grid {
          grid-template-columns: repeat(3, 1fr);
        }
      }

      @media (max-width: 992px) {
        .container {
          grid-template-columns: 1fr;
          padding: 0 15px;
        }
        .left-sidebar {
          position: fixed;
          left: -353px;
          top: 0;
          height: 100vh;
          width: 323px;
          background: #fff;
          z-index: 998;
          padding: 90px 20px 20px;
          overflow-y: auto;
          box-shadow: 5px 0 20px rgba(0, 0, 0, 0.3);
          transition: left 0.4s ease;
        }
        .left-sidebar.open {
          left: 0;
        }
        .sidebar-toggle {
          display: none;
        }
        .menu-toggle {
          display: flex;
        }
        .top-bar {
          flex-direction: row;
          justify-content: space-between;
          align-items: center;
          gap: 0;
        }
        .logo {
          height: 50px;
          flex-shrink: 0;
        }
        nav ul {
          display: none;
        }
        .live-video video {
          height: 350px;
        }
        .news-grid {
          grid-template-columns: 1fr 1fr;
        }
        nav ul {
          gap: 14px;
          font-size: 13px;
        }
      }

      @media (max-width: 768px) {
        .top-bar {
          justify-content: space-between;
        }
        .logo {
          height: 45px;
        }
        .live-video video {
          height: 280px;
        }
        .news-grid {
          grid-template-columns: 1fr;
        }
        .categories {
          grid-template-columns: 1fr 1fr;
        }
        .ticker span {
          font-size: 14px;
        }
        .live-info {
          padding: 6px 15px;
        }
      }

      @media (max-width: 480px) {
        .live-info {
          font-size: 12px;
          padding: 8px 12px;
          text-align: center;
          flex-direction: row;
          gap: 5px;
        }
        .section-header h2 {
          font-size: 19px;
        }
        .live-badge {
          font-size: 14px;
          padding: 8px 18px;
        }
        .categories {
          grid-template-columns: 1fr;
        }
        .mandi-grid {
          grid-template-columns: 1fr;
        }
        .ad-banner {
          font-size: 14px;
          padding: 20px 10px;
        }
        header {
          padding: 8px 15px;
        }
        .top-bar {
          padding: 0;
        }
        .logo {
          height: 40px;
        }
        .menu-toggle {
          font-size: 20px;
        }
      }
      /* NEWS CHANNEL STYLE FIXED CATEGORY BUTTONS */
      .categories-buttons-bar {
        background: linear-gradient(to bottom, #c80000, #a00000);
        padding: 7px 0;
        overflow-x: auto;
        white-space: nowrap;
        scrollbar-width: none;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
        border-bottom: 3px solid #ff1744;
      }

      .categories-buttons-bar::-webkit-scrollbar {
        display: none;
      }

      .cat-btn {
        display: inline-block;
        align-items: center;
        background: rgb(255, 255, 255);
        color: rgb(255, 0, 0);
        padding: 7px 12px;
        margin: 0 8px;
        border-radius: 10px;
        font-weight: 800;
        font-size: 16px;
        text-transform: uppercase;
        letter-spacing: 1px;
        transition: all 0.3s ease;
        backdrop-filter: blur(8px);
        border: 2px solid transparent;
        cursor: pointer;
      }

      .cat-btn:hover {
        background: #ff1744;
        color: #ffffff;
        border: 2px solid #fff;
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(255, 23, 68, 0.6);
      }

      .cat-btn.active {
        background: #ff0000;
        color: #ffffff;
        border: 2px solid #fff;
        box-shadow: 0 0 20px rgba(255, 255, 255, 0.6);
      }
      .logo-img{
      height:45px;
      width:auto;
      }
      @media (max-width: 600px) {
        .cat-btn {
          font-size: 12px;
          padding: 3px 6px;
          margin: 0px;
        }

        .logo-img{
height:30px;
width:auto;
        }
      }
      .close-sidebar {
        font-size:28px;
    background:none;
    border:none;
    float:right;
    cursor:pointer;
    background-color: #a00000;
    border-radius: 10px;
    padding: 10px;
    color:#ffffff;
    font-weight:bold;
    margin-bottom:10px;
      }

      @media  ( min-width: 600px) {
        .close-sidebar {
          font-size: 28px;
    background: none;
    border: none;
    float: right;
    cursor: pointer;
    background-color: #a0000013;
    border-radius: 10px;
    padding: 10px;
    color: #ffffff00;
    font-weight: bold;
    margin-bottom: 10px;
        }
      }

      /* Details Page Specific Styles */
      .breadcrumb {
        background: #f8f8f8;
        padding: 15px 20px;
        margin: 20px 0;
        border-radius: 8px;
        font-size: 14px;
      }
      .breadcrumb ol {
        list-style: none;
        display: flex;
        flex-wrap: wrap;
        gap: 5px;
        color: #666;
      }
      .breadcrumb a {
        color: #c80000;
        text-decoration: none;
      }
      .article-main {
        background: #fff;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
      }
      .article-header {
        padding: 20px;
        border-bottom: 1px solid #eee;
      }
      .article-header h1 {
        font-size: 28px;
        color: #c80000;
        line-height: 1.3;
        margin-bottom: 10px;
      }
      .article-meta {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: #666;
      }
      .article-body {
        padding: 20px;
        font-size: 16px;
        line-height: 1.7;
        color: #333;
      }
      .article-body p {
        margin-bottom: 15px;
      }
      .article-body blockquote {
        border-left: 4px solid #c80000;
        padding-left: 20px;
        margin: 20px 0;
        font-style: italic;
        color: #555;
        font-size: 18px;
      }
      .article-body h2 {
        color: #c80000;
        font-size: 22px;
        margin: 20px 0 10px;
      }
      .article-body ul {
        padding-left: 20px;
        margin: 10px 0;
      }
      .article-body li {
        margin-bottom: 5px;
      }
      .social-share {
        padding: 20px;
        border-top: 1px solid #eee;
        display: flex;
        gap: 15px;
        justify-content: center;
        background: #f8f8f8;
      }
      .social-share a {
        color: #c80000;
        text-decoration: none;
        font-size: 16px;
      }
      .related-section {
        padding: 20px;
        border-top: 1px solid #eee;
      }
      .related-section h2 {
        color: #c80000;
        font-size: 20px;
        margin-bottom: 15px;
      }
      .related-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 15px;
      }
      .related-card {
        background: #f9f9f9;
        padding: 10px;
        border-radius: 5px;
        transition: transform 0.3s;
      }
      .related-card:hover {
        transform: translateY(-5px);
      }
      .related-card img {
        width: 100%;
        height: 150px;
        object-fit: cover;
        border-radius: 5px;
      }
      .related-card h3 {
        font-size: 14px;
        margin: 10px 0;
        color: #333;
      }
      .related-card p {
        font-size: 12px;
        color: #666;
      }
      .related-card a {
        color: #c80000;
        text-decoration: none;
        font-size: 12px;
        font-weight: bold;
      }
      .bottom-ad {
        text-align: center;
        padding: 20px;
        background: #f9f9f9;
        margin: 20px 0;
      }
      .side-ad {
        background: #f9f9f9;
        padding: 10px;
        text-align: center;
        border-radius: 5px;
        margin-bottom: 20px;
      }
      .trending-sidebar {
        background: #fff;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
      }
      .trending-sidebar h2 {
        background: #c80000;
        color: #fff;
        padding: 15px;
        text-align: center;
        margin: 0;
      }
      .trending-list {
        padding: 15px;
      }
      .trending-item {
        padding: 12px;
        border-bottom: 1px solid #eee;
      }
      .trending-item:last-child {
        border-bottom: none;
      }
      .trending-item h4 {
        color: #c80000;
        font-size: 14px;
        margin-bottom: 5px;
      }
      .trending-item small {
        color: #666;
        font-size: 12px;
      }
      .feature-image {
        width: 100%;
        height: 400px;
        object-fit: cover;
      }
    </style>
  </head>
  <body>
    <div class="bg-spots"></div>

    <div class="loader" id="loader">
      <div class="spinner"></div>
      <p>Loading Article | E TIMES INDIA * 24...</p>
    </div>

    <%- include("layout/header") %>

    <div class="live-info">
      <div class="time" id="liveTime"></div>
      <div class="weather" id="weatherDisplay">
        <i class="fas fa-spinner fa-spin"></i> Detecting your location &
        weather...
      </div>
    </div>

    <!-- Categories Buttons Bar -->
    <div class="categories-buttons-bar">
    
    <%- include("layout/buttons") %>
  </div>

    <div class="container">
      <aside class="left-sidebar">
        <button 
    class="close-sidebar" 
    onclick="closeSidebar()" 
    style=""
  >
    ×
  </button>

        <script>
    function closeSidebar() {
      document.querySelector('.left-sidebar').classList.remove('open');
    }

    function openSidebar() {
      document.querySelector('.left-sidebar').classList.add('open');
    }

    // When clicking Mandi Rates button
    document.querySelector('.menu-toggle')
      .addEventListener('click', openSidebar);
  </script>

          <div class="mandi-section">
            <h2>Mandi Rates Today</h2>
            <div class="mandi-grid">
              <div class="mandi-city">
                <h3>Delhi</h3>
                <table class="mandi-table">
                  <tr>
                    <td>Wheat</td>
                    <td>₹2,450/Qtl</td>
                  </tr>
                  <tr>
                    <td>Rice</td>
                    <td>₹3,800</td>
                  </tr>
                  <tr>
                    <td>Maize</td>
                    <td>₹1,950</td>
                  </tr>
                </table>
              </div>
              <div class="mandi-city">
                <h3>Mumbai</h3>
                <table class="mandi-table">
                  <tr>
                    <td>Tomato</td>
                    <td>₹2,500</td>
                  </tr>
                  <tr>
                    <td>Onion</td>
                    <td>₹1,800</td>
                  </tr>
                  <tr>
                    <td>Potato</td>
                    <td>₹1,200</td>
                  </tr>
                </table>
              </div>
              <div class="mandi-city">
                <h3>Kolkata</h3>
                <table class="mandi-table">
                  <tr>
                    <td>Paddy</td>
                    <td>₹2,100</td>
                  </tr>
                  <tr>
                    <td>Sugarcane</td>
                    <td>₹3,200</td>
                  </tr>
                  <tr>
                    <td>Chilli</td>
                    <td>₹4,500</td>
                  </tr>
                </table>
              </div>
            </div>
          </div>
                 <div class="left-ad-section" style="width:300px; margin-top: 20px;">

  <% if (leftads && leftads.length > 0) { %>

      <% leftads.forEach(ad => { %>

        <div class="left-ad-box" style="margin-bottom:20px; width:300px;">

          <% if (ad.mediaType === "image") { %>

            <a href="/<%= ad.link || '#' %>" target="_blank">
              <img 
                src="/<%= ad.mediaUrl %>" 
                alt="<%= ad.title %>"
                style="width:250px; height:auto; display:block; object-fit:contain; border:1px solid #ccc; border-radius:4px;"
              >
            </a>

          <% } else if (ad.mediaType === "video") { %>

            <video 
              style="width:250px; height:auto; display:block; border:1px solid #ccc; border-radius:4px;" 
              autoplay 
              muted 
              loop 
              controls
            >
              <source src="/<%= ad.mediaUrl %>" type="video/mp4">
            </video>

          <% } %>

        </div>

      <% }) %>

  <% } else { %>

      <!-- Default Banner -->
      <div 
        style="
          width:300px;
          height:auto;
          padding:20px 0;
          text-align:center;
          background:#f2f2f2;
          border:1px solid #ccc;
          font-size:18px;
          font-weight:bold;
        "
      >
        ADVERTISEMENT <br> 300 × 250
      </div>

  <% } %>

</div>
      </aside>

       <main>
      <nav class="breadcrumb">
        <ol>
          <li><a href="/">Home</a></li> 
        </ol>
      </nav>

      <article class="article-main">
        <div class="article-header">
          <h1><%= news.headline %></h1>
          <div class="article-meta">
            <span>By <%= news.createdBy?.name || "Editorial Team" %></span>
            <span>
              <%= new Date(news.createdAt).toLocaleDateString('en-IN', { day: 'numeric', month: 'long', year: 'numeric' }) %>
              | <%= news.views %> views
            </span>
          </div>
        </div>

        <!-- Feature Media -->
       <!-- Feature Media - FULLY FIXED (No More Auto Download!) -->
<!-- ======== AAJ TAK STYLE LIVE VIDEO PLAYER (FULLY FIXED) ======== -->
<% if (news.mediaType === 'image' && news.image) { %>
  <img src="<%= news.image %>" alt="<%= news.headline %>" class="feature-image" loading="lazy" />

<% } else if (news.mediaType === 'video' && news.video) { %>

  <div style="  
  position: relative;
    margin-top: 0px;
    width: 100%;
    max-width: 900px;
    margin: auto;
    background: #ffffff;
    color: #ff0000;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);">
    
    <!-- TOP BAR: Logo + Typing Title -->
    <div style=" position: absolute;
      top: 0px;
      left: 0;
      width: 100%;
      padding: 0 5px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      z-index: 10;
      color: #a00000;">
      <img src="/logo/tag.png" alt="E TIMES INDIA" height="45">
      <div id="typingText" style=" font-size: 18px;
        font-weight: bold;
        white-space: nowrap;
        overflow: hidden;
        border-right: 3px solid #31010105;
        color: #a00000;">
        Loading Live...
      </div>
      <div></div>
    </div>

    <!-- MAIN VIDEO (16:9) -->
    <div style="position: relative; width: 100%; height: 0; padding-bottom: 56.25%; margin-top: 40px; border-radius: 5px; overflow: hidden;">
      
      <% 
        const url = news.video.trim();
        let embedSrc = "";
        let isDirect = false;

        // YOUTUBE (All formats)
        if (url.includes('youtube.com') || url.includes('youtu.be') || url.includes('shorts')) {
          let id = '';
          if (url.includes('youtu.be/')) id = url.split('youtu.be/')[1].split(/[?&]/)[0];
          else if (url.includes('v=')) id = url.split('v=')[1].split('&')[0];
          else if (url.includes('embed/')) id = url.split('embed/')[1].split('?')[0];
          else if (url.includes('shorts/')) id = url.split('shorts/')[1].split('?')[0];
          embedSrc = `https://www.youtube.com/embed/${id}?autoplay=0&rel=0&modestbranding=1&playsinline=1&iv_load_policy=3`;
        }
        // FACEBOOK
        else if (url.includes('facebook.com') || url.includes('fb.watch')) {
          embedSrc = `https://www.facebook.com/plugins/video.php?href=${encodeURIComponent(url)}&width=900&show_text=false&mute=0`;
        }
        // DAILYMOTION
        else if (url.includes('dailymotion.com') || url.includes('dai.ly')) {
          const id = url.split('/video/')[1]?.split('?')[0] || url.split('dai.ly/')[1]?.split('?')[0];
          embedSrc = `https://www.dailymotion.com/embed/video/${id}`;
        }
        // DIRECT MP4/WEBM
        else if (/\.(mp4|webm|ogg|mov)$/i.test(url)) {
          isDirect = true;
        }
        else {
          embedSrc = url;
        }
      %>

      <% if (isDirect) { %>
        <video controls autoplay muted loop playsinline poster="<%= news.image || '/logo/logo2.png' %>"
               style="position:absolute; top:0; left:0; width:100%; height:100%; object-fit:cover; border-radius:8px;">
          <source src="<%= url %>" type="video/mp4">
          <source src="<%= url %>" type="video/webm">
          Your browser does not support video.
        </video>
      <% } else { %>
        <iframe src="<%= embedSrc %>"
                style="position:absolute; top:0; left:0; width:100%; height:100%; border:none; border-radius:8px;"
                allowfullscreen allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
                loading="lazy"></iframe>
      <% } %>
    </div>

    <!-- LIVE TIME + LOGO (Top Right) -->
    <div style=" position: absolute;
      top: 3px;
      right: 10px;
      font-size: 10px;
      background: rgb(255, 255, 255);
      padding: 0px;
      border-radius: 4px;
      color: #8b0000fd;
      z-index: 20;
      font-weight: bold;
      display: flex;
      align-items: center;
      flex-direction: column;">
      <img src="/logo/logo.png" alt="E TIMES INDIA" style="width:60px; height:auto;">
      <div id="currentTime" style="font-weight:900; font-size:10px; color:#c80000; margin-top:0px; letter-spacing:1px;">00:00:00</div>
    </div>

    <!-- BOTTOM MARQUEE (Breaking News) -->
    <div style=" background: #a00000;
      padding: 10px 0;
      position: absolute;
      bottom: -5px;
      width: 100%;
      font-size: 16px;
      font-weight: bold;
      white-space: nowrap;
      overflow: hidden;
      color: #fff;
      z-index: 20;">
      <span id="marqueeText" style="display:inline-block; padding-left:100%; animation:marquee 35s linear infinite;">
        E TIMES INDIA LIVE • <%= news.headline %> • Latest Updates • Bihar Politics • National News • More Breaking...
      </span>
    </div>
  </div>

<% } else { %>
  <img src="https://picsum.photos/seed/<%= news._id %>/1200/600" alt="<%= news.headline %>" class="feature-image" loading="lazy" />
<% } %>

<!-- CSS & SCRIPT FOR ANIMATIONS -->
<style>
  @keyframes marquee {
    0%   { transform: translateX(0%); }
    100% { transform: translateX(-100%); }
  }
</style>

<script>
  // Dynamic Title (from news headline)
  const title = "<%= news.headline || 'Breaking News Live Updates' %>";
  document.getElementById("typingText").textContent = title;

  // Dynamic Marquee
  const marquee = "<%= news.highlightText?.[0] || 'E TIMES INDIA LIVE • ' + (news.headline || 'Latest News') + ' • Breaking Updates • Stay Tuned...' %>";
  document.getElementById("marqueeText").textContent = marquee;

  // Live Clock (24-hour)
  function updateClock() {
    const now = new Date();
    const time = now.toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false });
    document.getElementById("currentTime").textContent = time;
  }
  setInterval(updateClock, 1000);
  updateClock();

  // Typing Animation
  const typingEl = document.getElementById("typingText");
  let i = 0;
  typingEl.textContent = "";
  function type() {
    if (i < title.length) {
      typingEl.textContent += title.charAt(i);
      i++;
      setTimeout(type, 90);
    } else {
      setTimeout(() => { typingEl.textContent = ""; i = 0; type(); }, 4000);
    }
  }
  type();
</script>

        <div class="article-body">
          <% if (news.highlightText && news.highlightText.length > 0) { %>
            <blockquote><%= news.highlightText[0] %></blockquote>
          <% } %>
          <%- news.description.replace(/\n/g, '<br>') %>
        </div>

        <div class="social-share">
          <a href="https://www.facebook.com/sharer/sharer.php?u=https://yourdomain.com/news/<%= news._id %>" target="_blank">Facebook</a>
          <a href="https://twitter.com/intent/tweet?text=<%= encodeURIComponent(news.headline) %>&url=https://yourdomain.com/news/<%= news._id %>" target="_blank">X</a>
          <a href="https://wa.me/?text=<%= encodeURIComponent(news.headline + ' - https://yourdomain.com/news/' + news._id) %>" target="_blank">WhatsApp</a>
        </div>
      </article>

      <!-- Related News -->
     <% if (relatedNews && relatedNews.length > 0) { %>
  <section style="margin:40px 0;">
    <h2 style="font-size:24px; color:#c80000; margin-bottom:20px; padding-left:12px; border-left:6px solid #c80000; font-weight:700;">
      Related News
    </h2>
    
    <div style="display:flex; flex-wrap:wrap; gap:24px; justify-content:center; margin:0 auto;">
      <% relatedNews.forEach(item => { %>
        <a href="/<%= title %>/<%= item._id %>" 
           style="text-decoration:none; color:#222; display:block; width:100%; max-width:380px; flex:0 1 380px;">
          
          <div style="background:#fff; border-radius:12px; overflow:hidden; 
                      box-shadow:0 2px 16px rgba(160,0,0,0.15); 
                      border-left:7px solid #c80000; 
                      transition:all 0.3s ease; height:100%;">
            
            <!-- Image -->
            <img src="<%= item.image || 'https://picsum.photos/seed/'+item._id+'/400/250' %>" 
                 alt="<%= item.headline %>" loading="lazy"
                 style="width:100%; height:190px; object-fit:cover; background:#000;">
            
            <!-- Content -->
            <div style="padding:16px;">
              <!-- Date -->
              <div style="color:#c80000; font-size:12px; font-weight:600; margin-bottom:8px;">
                <%= new Date(item.createdAt).toLocaleDateString("en-IN", {day:"numeric", month:"short", year:"numeric"}) %>
              </div>
              
              <!-- Headline -->
              <h3 style="margin:0 0 10px; font-size:1.18rem; font-weight:700; line-height:1.3; color:#222;">
                <%= item.headline.length > 85 ? item.headline.substring(0,82)+'...' : item.headline %>
              </h3>
              
              <!-- Short Description -->
              <p style="margin:0; font-size:0.95rem; color:#444; line-height:1.5;">
                <%= item.description ? item.description.substring(0,110)+(item.description.length>110?'...':'') : 'Click to read full story...' %>
              </p>
            </div>
          </div>
          
          <!-- Hover Effect -->
          <style>
            a:hover div { 
              transform:translateY(-10px); 
              box-shadow:0 15px 35px rgba(160,0,0,0.25) !important; 
            }
          </style>
        </a>
      <% }) %>
    </div>
  </section>
<% } %>

      <div style="text-align:center;margin:40px 0;">
        <img src="/logo/logo.png" alt="Ad" style="max-width:100%; border-radius:8px;" />
      </div>
    </main>

      <aside class="right-sidebar">
        <div class="side-ad">
          <img src="/logo/logo.png" alt="Side Ad" style="width: 100%; max-width: 300px; height: 250px; object-fit: cover; border-radius: 5px;" />
          <p style="font-size: 12px; color: #666; margin-top: 5px;">300x250 Ad Space</p>
        </div>

    <div class="trending-sidebar" style="background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 6px 20px rgba(0,0,0,0.1);margin-bottom:20px;">
  <h2 style="background:#c80000;color:#fff;padding:16px 20px;text-align:center;margin:0;font-size:20px;font-weight:700;">
    Trending Now
  </h2>
  
  <div class="trending-list" style="padding:10px;">

    <% const trendingNews = relatedNews || newsList || []; %>

    <% trendingNews.slice(0, 10).forEach((item, index) => { %>

      <a href="/<%= title %>/<%= item._id %>" 
         style="text-decoration:none;color:#222;display:block;margin-bottom:16px;">

        <div style="background:#fff;border-radius:10px;overflow:hidden;
                    box-shadow:0 2px 12px rgba(160,0,0,0.12);border-left:5px solid #c80000;
                    transition:all 0.3s;display:flex;gap:12px;align-items:center;
                    padding:12px;">

          <!-- Rank -->
          <div style="background:#c80000;color:#fff;width:32px;height:32px;border-radius:50%;
                      display:flex;align-items:center;justify-content:center;font-weight:bold;font-size:14px;">
            <%= index + 1 %>
          </div>

          <!-- Media Thumbnail -->
          <div style="width:90px;height:60px;position:relative;flex-shrink:0;">

            <% if (item.mediaType === 'video') { %>

              <!-- Thumbnail --> 
              <img 
                src="<%= item.image || '/logo/video-thumb.jpg' %>" 
                style="width:100%;height:100%;object-fit:cover;border-radius:6px;"
                alt="<%= item.headline %>" />

              <!-- Play Icon Overlay -->
              <div style="
                position:absolute;top:50%;left:50%;
                transform:translate(-50%, -50%);
                width:30px;height:30px;
                background:rgba(0,0,0,0.6);
                border-radius:50%;display:flex;
                align-items:center;justify-content:center;">
                <i class="fas fa-play" style="color:#fff;font-size:14px;"></i>
              </div>

            <% } else { %>

              <!-- Image Thumbnail -->
              <img 
                src="<%= item.image || 'https://picsum.photos/seed/'+item._id+'/120/80' %>" 
                style="width:100%;height:100%;object-fit:cover;border-radius:6px;"
                alt="<%= item.headline %>" />

            <% } %>

          </div>

          <!-- Text -->
          <div style="flex-grow:1;">
            <h4 style="margin:0;font-size:14px;font-weight:700;line-height:1.3;">
              <%= item.headline.length > 60 ? item.headline.substring(0,57)+'...' : item.headline %>
            </h4>

            <p style="margin:4px 0 0;font-size:12px;color:#666;">
              <%= item.description ? item.description.substring(0,70)+(item.description.length>70?'...':'') : '' %>
            </p>

            <small style="color:#c80000;font-size:10px;display:block;margin-top:4px;">
              <%= new Date(item.createdAt).toLocaleDateString("en-IN", {day:"numeric", month:"short"}) %>
            </small>
          </div>

        </div>
      </a>

    <% }) %>

    <% if (!trendingNews.length) { %>
      <p style="text-align:center;color:#999;padding:20px;font-size:14px;">
        No trending news available
      </p>
    <% } %>

  </div>
</div>

           <div class="right-ads" style="margin-top: 20; padding: 0;">
  <% if (rightads && rightads.length > 0) { %>

    <% rightads.forEach(ad => { %>

      <div class="ad-box" style="margin-bottom:20px;">

        <% if (ad.mediaType === "image") { %>
            <a href="/<%= ad.link || '#' %>" target="_blank">
              <img 
                src="/<%= ad.mediaUrl %>" 
                alt="/<%= ad.title %>" 
                style="width:350px; height:auto; display:block; object-fit:contain;"
              >
            </a>

        <% } else if (ad.mediaType === "video") { %>
            <video 
              style="width:350px; height:auto; display:block;" 
              autoplay 
              muted 
              loop 
             
            >
              <source src="/<%= ad.mediaUrl %>" type="video/mp4">
            </video>
        <% } %>

      </div>

    <% }) %>

  <% } else { %>
      <div class="ad-banner">ADVERTISEMENT<br>300x600</div>
  <% } %>
</div>
      </aside>
    </div>
    <%- include("layout/footer") %>


    <script>
      // Live Time
      function updateTime() {
        const now = new Date();
        const options = {
          timeZone: "Asia/Kolkata",
          hour12: true,
          hour: "2-digit",
          minute: "2-digit",
          second: "2-digit",
        };
        document.getElementById("liveTime").innerText =
          now.toLocaleString("en-US", options) + " IST";
      }
      setInterval(updateTime, 1000);
      updateTime();

      // Weather
      function getWeather() {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(
            async (pos) => {
              const lat = pos.coords.latitude;
              const lon = pos.coords.longitude;

              try {
                const res = await fetch(
                  `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,weathercode&timezone=Asia/Kolkata`
                );
                const data = await res.json();
                const temp = Math.round(data.current.temperature_2m);
                const code = data.current.weathercode;

                // Simple weather description
                const weatherDesc = {
                  0: "Clear",
                  1: "Mainly Clear",
                  2: "Partly Cloudy",
                  3: "Overcast",
                  45: "Fog",
                  48: "Fog",
                  51: "Light Drizzle",
                  53: "Drizzle",
                  55: "Heavy Drizzle",
                  61: "Light Rain",
                  63: "Rain",
                  65: "Heavy Rain",
                  71: "Light Snow",
                  73: "Snow",
                  75: "Heavy Snow",
                  95: "Thunderstorm",
                };
                const desc = weatherDesc[code] || "Cloudy";

                // Get city name (reverse geocoding - free)
                const cityRes = await fetch(
                  `https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lon}&format=json`
                );
                const cityData = await cityRes.json();
                const city =
                  cityData.address.city ||
                  cityData.address.town ||
                  cityData.address.state_district ||
                  "Your Location";

                document.getElementById(
                  "weatherDisplay"
                ).innerHTML = `<i class="fas fa-map-marker-alt"></i> ${city}: ${temp}°C | ${desc}`;
              } catch (err) {
                document.getElementById(
                  "weatherDisplay"
                ).innerHTML = `<i class="fas fa-cloud-sun"></i> Weather unavailable`;
              }
            },
            () => {
              document.getElementById(
                "weatherDisplay"
              ).innerHTML = `<i class="fas fa-cloud-sun"></i> Delhi: 24°C | Haze`;
            }
          );
        } else {
          document.getElementById(
            "weatherDisplay"
          ).innerHTML = `<i class="fas fa-cloud-sun"></i> Delhi: 24°C | Haze`;
        }
      }
      getWeather();

      // Loader
      window.onload = () => {
        setTimeout(() => {
          document.getElementById("loader").style.opacity = "0";
          setTimeout(() => {
            document.getElementById("loader").style.display = "none";
          }, 600);
        }, 1500);
      };
    </script>
  </body>
</html>